<script src="https://cdn.tailwindcss.com"></script>
<div class="max-w-4xl mx-auto p-8">
  <header class="mb-6 text-center">
    <h1 class="text-3xl font-bold text-gray-800">Projeto ENEM: Equipe Python ‚Äî Tarefas Simples</h1>
    <p class="mt-2 text-sm text-gray-600">Instru√ß√µes claras para implementar 3 rotas b√°sicas: listar quest√µes, inserir quest√£o e dar upvote.</p>
  </header>

  <ol class="space-y-6 list-none">

    <!-- Listar -->
    <li class="bg-white shadow rounded-2xl p-6 border border-gray-100">
      <h2 class="text-lg font-semibold text-gray-800">Tarefa 1 ‚Äî Listar quest√µes (GET)</h2>
      <p class="mt-2 text-gray-700">
        Objetivo: criar uma rota que devolve uma lista de quest√µes. Pense nela como uma "p√°gina" de perguntas.
      </p>

      <div class="mt-3 text-sm text-gray-700 space-y-2">
        <p><strong>Endpoint sugerido:</strong> <code>GET /api/questions</code></p>
        <p><strong>Par√¢metros simples:</strong> <code>page</code> (n√∫mero da p√°gina), <code>per_page</code> (quantas por p√°gina), <code>search</code> (texto para buscar).</p>

        <p><strong>Exemplo de resposta:</strong></p>
        <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto">
{
  "page": 1,
  "per_page": 10,
  "total": 42,
  "items": [
    {
      "id": 1,
      "enunciado": "Qual √© a capital do Brasil?",
      "nivel_dificuldade": "facil",
      "upvotes": 3,
      "created_at": "2025-09-01T12:34:56Z"
    }
  ]
}
        </pre>

      </div>
    </li>

    <!-- Inserir -->
    <li class="bg-white shadow rounded-2xl p-6 border border-gray-100">
      <h2 class="text-lg font-semibold text-gray-800">Tarefa 2 ‚Äî Inserir nova quest√£o (POST)</h2>
      <p class="mt-2 text-gray-700">
        Objetivo: criar uma rota que salva uma nova quest√£o no banco. Vai receber um JSON com a quest√£o e as alternativas.
      </p>

      <div class="mt-3 text-sm text-gray-700 space-y-2">
        <p><strong>Endpoint sugerido:</strong> <code>POST /api/questions</code></p>

        <p><strong>Exemplo de payload (envio):</strong></p>
        <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto">
{
  "enunciado": "Qual √© a capital do Brasil?",
  "alternativas": [
    {"id":"A","texto":"S√£o Paulo"},
    {"id":"B","texto":"Bras√≠lia"},
    {"id":"C","texto":"Rio de Janeiro"},
    {"id":"D","texto":"Salvador"}
  ],
  "resposta_correta": "B",
  "nivel_dificuldade": "facil",
  "competencia": "Geografia"
}
        </pre>

        <p><strong>Exemplo de resposta (sucesso):</strong></p>
        <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto">
HTTP/1.1 201 Created
Location: /api/questions/45
{
  "id": 45,
  "message": "Quest√£o criada com sucesso"
}
        </pre>

        <p class="text-gray-600">Passos simples para implementar:</p>
        <ul class="pl-6 list-disc text-gray-700">
          <li>Validar que o campo <code>enunciado</code> existe e n√£o est√° vazio.</li>
          <li>Verificar que existem 5 alternativas com ids A/B/C/D/E.</li>
          <li>Confirmar que <code>resposta_correta</code> corresponde a uma das alternativas.</li>
          <li>Salvar em duas tabelas: <code>questoes</code> e <code>alternativas</code>. Pe√ßa ao time SQL o exemplo abaixo.</li>
        </ul>

        <p class="text-gray-600">SQL m√≠nimo de exemplo (para alinhar com o time SQL):</p>
        <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto">
-- insere a quest√£o e em seguida as alternativas (exemplo simples)
INSERT INTO questoes (enunciado, resposta_correta, nivel_dificuldade, competencia, upvotes, created_at)
VALUES (..., ..., ..., ..., 0, NOW());

-- depois insere 4 linhas em alternativas ligadas ao id da quest√£o
        </pre>
      </div>
    </li>

    <!-- Upvote -->
    <li class="bg-white shadow rounded-2xl p-6 border border-gray-100">
      <h2 class="text-lg font-semibold text-gray-800">Tarefa 3 ‚Äî Dar upvote em uma quest√£o (POST)</h2>
      <p class="mt-2 text-gray-700">
        Objetivo: aumentar em 1 o contador de upvotes de uma quest√£o quando algu√©m clicar em "Curtir".
      </p>

      <div class="mt-3 text-sm text-gray-700 space-y-2">
        <p><strong>Endpoint sugerido:</strong> <code>POST /api/questions/{id}/upvote</code></p>

        <p><strong>Exemplo de resposta:</strong></p>
        <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto">
{
  "id": 1,
  "upvotes": 4
}
        </pre>

        <p class="text-gray-600">Como fazer de forma simples:</p>
        <ol class="pl-6 list-decimal text-gray-700">
          <li>Receba o <code>id</code> da quest√£o na URL.</li>
          <li>Execute um comando que soma 1 ao campo <code>upvotes</code> (o time SQL pode usar: <code>UPDATE questoes SET upvotes = upvotes + 1 WHERE id = ?</code>).</li>
          <li>Retorne o novo valor de upvotes ao cliente.</li>
        </ol>

        <p class="text-gray-600">Observa√ß√£o pr√°tica: este m√©todo funciona bem e √© simples ‚Äî perfeito para quem est√° come√ßando.</p>
      </div>
    </li>
  </ol>

  <div class="mt-6 p-4 bg-green-50 border-l-4 border-green-400 rounded">
    <h3 class="font-semibold text-gray-800">Guia r√°pido para quem vai implementar agora</h3>
    <ul class="pl-6 list-disc mt-2 text-gray-700">
      <li>Fa√ßa uma rota de cada vez: primeiro <strong>listar</strong>, depois <strong>inserir</strong>, por fim <strong>upvote</strong>.</li>
      <li>Teste com exemplos pequenos (use o JSON de exemplo acima).</li>
      <li>Pe√ßa ao time SQL os nomes das colunas exatas antes de gravar ‚Äî use os exemplos acima como ponto de partida.</li>
      <li>Se ficar travado, copie e cole a requisi√ß√£o de teste no Postman/Insomnia e veja a resposta do servidor.</li>
    </ul>
  </div>

  <!-- Exemplos de requisi√ß√µes convertidos para HTML -->
  <section class="mt-8 space-y-6">
    <h2 class="text-2xl font-semibold text-gray-800">Exemplos de requisi√ß√µes</h2>

    <div class="bg-white shadow rounded p-6 border border-gray-100">
      <h3 class="font-semibold">1Ô∏è‚É£ Listar quest√µes (GET /api/questions)</h3>
      <p class="text-sm text-gray-700 mt-2">Lista as primeiras 10 quest√µes e exemplo de busca:</p>
      <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto mt-3"># Lista as primeiras 10 quest√µes
curl -X GET "https://gsuzeda.pythonanywhere.com/api/questions?page=1&per_page=10" \
     -H "Content-Type: application/json"

# Buscar quest√µes com texto espec√≠fico
curl -X GET "https://gsuzeda.pythonanywhere.com/api/questions?page=1&per_page=10&search=capital" \
     -H "Content-Type: application/json"
</pre>
    </div>

    <div class="bg-white shadow rounded p-6 border border-gray-100">
      <h3 class="font-semibold">2Ô∏è‚É£ Inserir nova quest√£o (POST /api/questions)</h3>
      <p class="text-sm text-gray-700 mt-2">Exemplo de payload para criar uma nova quest√£o:</p>
      <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto mt-3">curl -X POST "https://gsuzeda.pythonanywhere.com/api/questions" \
     -H "Content-Type: application/json" \
     -d '{
           "enunciado": "Qual √© a capital do Brasil?",
           "alternativas": [
             {"id":"A","texto":"S√£o Paulo"},
             {"id":"B","texto":"Bras√≠lia"},
             {"id":"C","texto":"Rio de Janeiro"},
             {"id":"D","texto":"Salvador"}
           ],
           "resposta_correta": "B",
           "nivel_dificuldade": "facil",
           "competencia": "Geografia"
         }'
</pre>
      <p class="text-sm text-gray-600 mt-2">A resposta deve retornar o <code>id</code> da nova quest√£o e a mensagem de sucesso.</p>
    </div>

    <div class="bg-white shadow rounded p-6 border border-gray-100">
      <h3 class="font-semibold">3Ô∏è‚É£ Dar upvote em uma quest√£o (POST /api/questions/{id}/upvote)</h3>
      <p class="text-sm text-gray-700 mt-2">Exemplo de requisi√ß√£o para incrementar o contador de upvotes:</p>
      <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto mt-3"># Supondo que o id da quest√£o seja 1
curl -X POST "https://gsuzeda.pythonanywhere.com/api/questions/1/upvote" \
     -H "Content-Type: application/json"
</pre>
      <p class="text-sm text-gray-600 mt-2">A resposta mostrar√° o <code>id</code> da quest√£o e o novo valor de <code>upvotes</code>.</p>
    </div>

    <div class="bg-white shadow rounded p-6 border border-gray-100">
      <h3 class="font-semibold">4Ô∏è‚É£ Listar usu√°rios (GET /usuarios)</h3>
      <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto mt-3">curl -X GET "https://gsuzeda.pythonanywhere.com/usuarios" \
     -H "Content-Type: application/json"
</pre>
    </div>

    <div class="bg-white shadow rounded p-6 border border-gray-100">
      <h3 class="font-semibold">5Ô∏è‚É£ Processar JSON simples (POST /processar)</h3>
      <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto mt-3">curl -X POST "https://gsuzeda.pythonanywhere.com/processar" \
     -H "Content-Type: application/json" \
     -d '{"nome": "Maria"}'
</pre>
      <p class="text-sm text-gray-600 mt-2">Retorna uma mensagem de confirma√ß√£o e o JSON enviado.</p>
    </div>
    
  <div class="bg-white shadow rounded p-6 border border-gray-100">
    <h3 class="font-semibold">üß≠ Exemplo: implementa√ß√£o m√≠nima em Flask + MySQL</h3>
    <p class="text-sm text-gray-700 mt-2">Exemplo de servidor em Python usando Flask e mysql-connector. Use apenas como refer√™ncia; remova credenciais reais antes de publicar.</p>
    <pre class="bg-gray-50 p-3 rounded text-xs overflow-x-auto mt-3"><code>from flask import Flask, request, jsonify
import mysql.connector
from mysql.connector import Error

app = Flask(__name__)

# Fun√ß√£o para conectar ao banco de dados MySQL
def get_db_connection():
  return mysql.connector.connect(
    host="gsuzeda.mysql.pythonanywhere-services.com",
    user="gsuzeda",
    password="segredo!",
    database="gsuzeda$default"
  )

# ------------------------
# Rota 1: Listar quest√µes
# ------------------------
@app.route("/api/questions", methods=["GET"])
def listar_questoes():
  page = int(request.args.get("page", 1))
  per_page = int(request.args.get("per_page", 10))
  search = request.args.get("search", "")

  offset = (page - 1) * per_page

  try:
    conn = get_db_connection()
    cursor = conn.cursor(dictionary=True)

    cursor.execute("SELECT COUNT(*) as total FROM questoes WHERE enunciado LIKE %s", (f"%{search}%",))
    total = cursor.fetchone()["total"]

    cursor.execute("""
      SELECT id, enunciado, nivel_dificuldade, upvotes, created_at
      FROM questoes
      WHERE enunciado LIKE %s
      ORDER BY created_at DESC
      LIMIT %s OFFSET %s
    """, (f"%{search}%", per_page, offset))

    questoes = cursor.fetchall()
    cursor.close()
    conn.close()

    return jsonify({
      "page": page,
      "per_page": per_page,
      "total": total,
      "items": questoes
    })

  except Error as e:
    return jsonify({"erro": f"Erro ao acessar o banco de dados: {str(e)}"}), 500

# ------------------------
# Rota 2: Inserir nova quest√£o
# ------------------------
@app.route("/api/questions", methods=["POST"])
def inserir_questao():
  data = request.get_json()
  if not data:
    return jsonify({"erro": "Nenhum JSON recebido"}), 400

  enunciado = data.get("enunciado")
  alternativas = data.get("alternativas", [])
  resposta_correta = data.get("resposta_correta")
  nivel_dificuldade = data.get("nivel_dificuldade", "facil")
  competencia = data.get("competencia", "")

  if not enunciado or len(alternativas) < 4 or resposta_correta not in [a["id"] for a in alternativas]:
    return jsonify({"erro": "JSON inv√°lido ou incompleto"}), 400

  try:
    conn = get_db_connection()
    cursor = conn.cursor()

    cursor.execute("""
      INSERT INTO questoes (enunciado, resposta_correta, nivel_dificuldade, competencia, upvotes, created_at)
      VALUES (%s, %s, %s, %s, 0, NOW())
    """, (enunciado, resposta_correta, nivel_dificuldade, competencia))
    conn.commit()
    questao_id = cursor.lastrowid

    for alt in alternativas:
      cursor.execute("""
        INSERT INTO alternativas (questao_id, alternativa_id, texto)
        VALUES (%s, %s, %s)
      """, (questao_id, alt["id"], alt["texto"]) )
    conn.commit()

    cursor.close()
    conn.close()

    return jsonify({"id": questao_id, "message": "Quest√£o criada com sucesso"}), 201

  except Error as e:
    return jsonify({"erro": f"Erro ao acessar o banco de dados: {str(e)}"}), 500

# ------------------------
# Rota 3: Dar upvote em uma quest√£o
# ------------------------
@app.route("/api/questions/<int:questao_id>/upvote", methods=["POST"])
def upvote_questao(questao_id):
  try:
    conn = get_db_connection()
    cursor = conn.cursor(dictionary=True)

    cursor.execute("UPDATE questoes SET upvotes = upvotes + 1 WHERE id = %s", (questao_id,))
    conn.commit()

    cursor.execute("SELECT id, upvotes FROM questoes WHERE id = %s", (questao_id,))
    questao = cursor.fetchone()

    cursor.close()
    conn.close()

    if not questao:
      return jsonify({"erro": "Quest√£o n√£o encontrada"}), 404

    return jsonify(questao)

  except Error as e:
    return jsonify({"erro": f"Erro ao acessar o banco de dados: {str(e)}"}), 500

if __name__ == "__main__":
  app.run(debug=True)
</code></pre>
  </div>
  </section>
</div>


